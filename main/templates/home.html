 {% load i18n %}
<!DOCTYPE html>
<html data-ng-app="blindMaps" data-ng-controller="AppCtrl" lang="{{LANGUAGE_CODE}}">
  <head>
    <meta charset="utf-8">
    <title ng-bind="title" ng-init="initTitle('{{ title }}')">{{ title }}</title>
    {% if isProduction  %}
        <script type='text/javascript'>
        window.Muscula = { settings:{
            logId:"c851276b-6467-4182-a63a-045d86e9974a", suppressErrors: false, branding: 'none'
        }};
        (function () {
            var m = document.createElement('script'); m.type = 'text/javascript'; m.async = true;
            m.src = (window.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//musculahq.appspot.com/Muscula.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(m, s);
            window.Muscula.run=function(c){eval(c);window.Muscula.run=function(){};};
            window.Muscula.errors=[];window.onerror=function(){window.Muscula.errors.push(arguments);
            return window.Muscula.settings.suppressErrors===undefined;}
        })();
        </script>
	{% endif %}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% trans 'meta content' %}">
    <meta name="keywords" content="{% trans 'meta keywords' %}" />
    <link rel="shortcut icon" type="image/png" href="/favicon.ico"/>

    <!-- Le styles -->
    <style>
        {% include "above-fold-bootstrap.css" %}
        {% include "generated/above-fold.css" %}
    </style>

  </head>

  <body data-spy="scroll" data-target=".bs-docs-sidebar">
  <div id="wrap">
    <!-- Navbar
    ================================================== -->


    <div class="navbar navbar-inverse">
        <div class="container">

    <!-- .navbar-toggle is used as the toggle for collapsed navbar content -->
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>

      <a class="navbar-brand" href="#">{% trans "Slepé Mapy" %}</a>
      <div id="nav-main" class="collapse navbar-collapse navbar-responsive-collapse">
        <ul class="nav navbar-nav  pull-left">
                <li ng-class="'/view/world/'|isActive">
                  <a href="#/view/world/">{% trans "Svět" %}</a>
                </li>
                <li class="dropdown">
                  <a id="drop-continents" href=""  class="dropdown-toggle" data-toggle="dropdown">
                    {% trans "Kontinenty" %} <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="drop-continents">
                    {% for continent in continents %}
                    <li><a href="#/view/{{ continent.code }}/">{{ continent.name }}</a></li>
                    {% endfor %}
                  </ul>
                </li>
                <li class="dropdown">
                  <a id="drop-states" href=""  class="dropdown-toggle" data-toggle="dropdown">
                    {% trans "Státy" %} <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="drop-states">
                    {% for state in states %}
                    <li><a href="#/view/{{ state.code }}/">{{ state.name }}</a></li>
                    {% endfor %}
                  </ul>
                </li>
                <li ng-class="'/overview/'|isActive">
                  <a href="#/overview/">{% trans "Přehled map" %}</a> 
                </li>
        </ul>
          ...
            <ul class="nav ng-cloak navbar-nav pull-right"
                ng-init="initUser('{{user.username}}',{{user.points}}, '{{user.email}}')">
                <li class="dropdown" ng-show="user.username === ''" >
                  <a href="" 
                     role="button" 
                     class="dropdown-toggle drop-login atooltip"
                     title="{% trans "Přihlašte se jednoduše přes Google nebo Facebook, aby si systém váše znalosti pamatoval i příště." %}"
                     container="body"
                     data-toggle="dropdown">
                    {% trans "Přihlásit se" %} <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu login" role="menu" aria-labelledby="drop-login">
                    <li>
                      <a class="btn btn-danger btn-lg btn-block" href="/login/google/">
                        <i class="social-google"></i> {% trans "přes Google" %}
                      </a>
                    </li>
                    <li>
                      <a class="btn btn-primary btn-lg btn-block" href="/login/facebook/">
                        <i class="social-facebook"></i>{% trans "přes Facebook" %}
                      </a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown" ng-show="user.username !== ''">
                  <a id="drop1" href="" role="button" class="dropdown-toggle" data-toggle="dropdown">
                    <i class="glyphicon glyphicon-user"></i>
                    <span ng-bind="user.username"></span> <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                    <li class="forgot-pwd">
                      <a href="#/" ng-click="logout()">
                        <i class="glyphicon glyphicon-log-out"></i> 
                        {% trans "Odhlásit se" %}
                      </a>
                    </li>
                  </ul>
                </li>
              <li class="points"
                  tooltip="{% trans "Body - přibývají za každou správnou odpověď" %}" 
                  tooltip-placement="bottom"
                  ng-show="user.points">
                <a><span class="badge" ng-bind="user.points"></span></a>
            </li>
              <li class="dropdown">
                <a href="" role="button" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="flag-{{ LANGUAGE_CODE}}"></i> <b class="caret"></b>
                  <input type="hidden" ng-model="language_code" ng-init="language_code='{{ LANGUAGE_CODE }}'"/>
                </a>
                <ul class="dropdown-menu">
                    {% for lang in LANGUAGES %}
                    <li>
                      <a class="menu-link" href="/{{ lang.0 }}/#{%verbatim%}{{location.path()}}{%endverbatim%}">
                        <i class="flag-{{ lang.0 }}"></i> {% trans lang.1 %}
                      </a>
                    </li>
                    {% endfor %}
                </ul>
              </li>
            </ul>
        </div><!-- /.nav-collapse -->
      </div><!-- /.container -->
    </div>
    <!-- Main content
    ================================================== -->
    <div data-ng-view id="ng-view" ng-class="vip() && 'vip'">
        {% include "generated/homepage.html" %}
    </div>
  </div>

    <div id="feedback">
      <a href="" ng-click="openFeedback()">
        {% trans "Napište nám"%}
      </a>
    </div>
    <div id="footer">
      {% if LANGUAGE_CODE == "cs" %}
      <a href="#/about">{% trans "O projektu" %}</a> 
      &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
      {% endif %}
      <a href="" ng-click="openFeedback()">
        {% trans "Napište nám"%}
      </a>
      &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
      <a href="https://plus.google.com/+SlepemapyCz/">Google+</a>
      &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
      <a href="https://www.facebook.com/slepemapy">Facebook</a>
   {% if LANGUAGE_CODE == "cs" %}
      &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
      Vyzkoušejte také <a href="http://slepaanatomie.cz" target="_blank">Slepou Anatomii</a>
    {% endif %}

    <script type="text/ng-template" id="feedback_modal.html">
        <div class="modal-header">
            <h3 class="modal-title">{% trans "Napište nám"%}</h3>
        </div>
        <div class="modal-body">
            <label>
              {% trans "Feedback text label"%}
            </label>
            <textarea ng-model="feedback.text" class="form-control" rows="8" ></textarea>
            <label>
              {% trans "Vaše emailová adresa (nepovinné)"%}
            </label>
            <input type="text" ng-model="feedback.email" class="form-control"/>
            <br>
            {%verbatim%}
            <alert ng-repeat="alert in alerts" type="{{alert.type}}"
            close="closeAlert($index)">{{alert.msg}}</alert>
            {%endverbatim%}
        </div>
        <div class="modal-footer">
            <button ng-disabled="sending" class="btn btn-primary" ng-click="send()">
              {% trans "Odeslat"%}
            </button>
            <button class="btn btn-danger" ng-click="cancel()">
              {% trans "Zavřít"%}
            </button>
        </div>
    </script>

    </div>
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="{% url 'django.views.i18n.javascript_catalog' %}"></script>
    {% for file in js_files %}
    <script src="{{ file }}"></script>
    {% endfor %}

    {% for file in css_files %}
    <link href="{{ file }}" rel="stylesheet">
    {% endfor %}

    <!-- Place this tag after the last +1 button tag. -->
    <script type="text/javascript">
      window.___gcfg = {lang: '{{LANGUAGE_CODE}}'};

      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/platform.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>

    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/{{LANGUAGE_CODE}}_CZ/all.js#xfbml=1&appId=543575712384201";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
    {% if isProduction  %}
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-43054672-1', 'slepemapy.cz');

        </script>
    {% endif %}
  </body>
</html>

